<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculate Genetic Interactions for Paired CRISPR Targets • gimap</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Calculate Genetic Interactions for Paired CRISPR Targets">
<meta property="og:description" content="Helps find meaningful patterns in complex genetic experiments. First gimap takes data from paired CRISPR (Clustered regularly interspaced short palindromic repeats) screens that has been pre-processed to counts table of paired gRNA (guide Ribonucleic Acid) reads. The input data will have cell counts for how well cells grow (or dont grow) when different genes or pairs of genes are disabled. The output of the gimap' package is genetic interaction scores which are the distance between the observed CRISPR score and the expected CRISPR score. The expected CRISPR scores are what we expect for the CRISPR values to be for two unrelated genes. The further away an observed CRISPR score is from its expected score the more we suspect genetic interaction. The work in this package is based off of original research from the Alice Berger lab at Fred Hutchinson Cancer Center (2021) &lt;doi:10.1016/j.celrep.2021.109597&gt;.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">gimap</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/quick-start.html">Quick Start</a>
    </li>
    <li>
      <a href="articles/timepoint-example.html">gimap for Timepoint Experiment</a>
    </li>
    <li>
      <a href="articles/treatment_example.html">gimap for Treatment Experiment</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/FredHutch/gimap/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="gimap---genetic-interaction-mapping-for-dual-target-crispr-screens">gimap - Genetic Interaction MAPping for dual target CRISPR screens<a class="anchor" aria-label="anchor" href="#gimap---genetic-interaction-mapping-for-dual-target-crispr-screens"></a>
</h1></div>
<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->
<p><strong>Table of Contents</strong> <em>generated with <a href="https://github.com/thlorenz/doctoc" class="external-link">DocToc</a></em></p>
<ul>
<li><a href="#background-on-paired-guide-crispr">Background on paired guide CRISPR</a></li>
<li><a href="#what-is-gimap">What is gimap?</a></li>
<li><a href="#example-output-from-this-package">Example output from this package:</a></li>
<li><a href="#pgpen-library-design">pgPEN library design</a></li>
<li>
<a href="#about-genetic-interaction-scores">About Genetic Interaction Scores</a>
<ul>
<li><a href="#expected-crispr-scores">Expected CRISPR scores</a></li>
<li><a href="#normalization">Normalization</a></li>
</ul>
</li>
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#getting-started-tutorial">Getting Started Tutorial</a></li>
<li><a href="#docker-image">Docker image</a></li>
<li><a href="#citations">Citations:</a></li>
</ul>
<!-- END doctoc generated TOC please keep comment here to allow auto update --><div class="section level2">
<h2 id="background-on-paired-guide-crispr">Background on paired guide CRISPR<a class="anchor" aria-label="anchor" href="#background-on-paired-guide-crispr"></a>
</h2>
<p>Some genes have “backup copies” - these are called paralog genes. Think of it like having a spare tire in your car - if one fails, the other can often do a similar job. This redundancy makes it tricky to study what these genes do, because if you knock out just one gene, its partner might pick up the slack.</p>
<p>CRISPR allows genes to be knocked out so we can see what their function is. But because of paralog redundancy it can be hard to parse out what genes are actually involved. So instead of just targeting one gene at a time, paired guide CRISPR screening allows us to knock out two genes simultaneously.</p>
<p>It’s particularly useful for understanding: - What happens when you disable both backup copies of a gene - How different genes might work together - Which gene combinations are essential for cell survival</p>
</div>
<div class="section level2">
<h2 id="what-is-gimap">What is gimap?<a class="anchor" aria-label="anchor" href="#what-is-gimap"></a>
</h2>
<p>gimap - is a software tool that helps make sense of paired CRISPR screening data. Here’s what it does:</p>
<ol style="list-style-type: decimal">
<li>Takes data from paired CRISPR screens that has been pre-processed by the pgmap software, or any counts table of paired gRNA reads</li>
<li>The input data will have cell counts for how well cells grow (or don’t grow) when different genes or pairs of genes are disabled</li>
<li>gimap can take this data and helps identify interesting patterns, like:
<ul>
<li>When disabling two genes together is more devastating than you’d expect from disabling them individually (called synthetic lethality)</li>
<li>When genes work together cooperatively</li>
<li>Which gene combinations might be important in diseases like cancer gimap can help find meaningful patterns in complex genetic experiments. It’s particularly focused on analyzing data generated by screening cells with the Berger Lab paired gRNA CRISPR screening library, called pgPEN (paired guide RNAs for genetic interaction mapping). <br>
</li>
</ul>
</li>
</ol>
</div>
<div class="section level2">
<h2 id="example-output-from-this-package">Example output from this package:<a class="anchor" aria-label="anchor" href="#example-output-from-this-package"></a>
</h2>
<p>Here’s an example Volcano plot with the genetic interaction scores and statistical tests from this package: <br><img src="https://github.com/FredHutch/gimap/blob/main/vignettes/images/volcano_plot.png?raw=true" alt="Example results from this package"><br><br> And here is what the main summary calculations look like: <img src="https://github.com/FredHutch/gimap/blob/main/vignettes/images/results_table.png?raw=true" alt="Example results table"><br><br> The gimap package is based off of the <a href="https://github.com/FredHutch/GI_mapping" class="external-link">code and research from the Berger Lab</a></p>
<p><a href="https://fredhutch.github.io/gimap/articles/quick-start.html" class="external-link">Go to <strong>Quick Start</strong> to get going!</a></p>
</div>
<div class="section level2">
<h2 id="pgpen-library-design">pgPEN library design<a class="anchor" aria-label="anchor" href="#pgpen-library-design"></a>
</h2>
<p>The <code>gimap</code> package is based off of an original paired CRISPR knockout library design from the Berger lab.</p>
<p>There are four target types included in the custom Berger lab pgPEN library:</p>
<ul>
<li>
<code>double_targeting</code> - these cells have two different genes that have been knocked out with pgRNAs. This is sometimes noted as <code>"gene_gene"</code>
</li>
<li>
<code>single_targeting</code> - these cells have one gene that have been knocked out with pgRNA and another that is designed to not target any gene. This is includes <code>"gene_ctrl"</code> and <code>"ctrl_gene"</code>.</li>
<li>
<code>positive_control</code> - these cells have one <strong>essential control</strong> gene that has been knocked out with pgRNA and another that is designed to NOT target any genes. These are also noted as This is includes <code>"gene_ctrl"</code> and <code>"ctrl_gene"</code> but for when the gene is an essential gene, e.g. required in most cell lines for survival.</li>
<li>
<code>negative_control</code> - these cells have two pgRNAs designed to NOT target any genes. This is noted as <code>"ctrl_ctrl"</code>.</li>
</ul>
<p>In the instance of a single gene pair: e.g. <code>geneA_geneB</code>, there are 32 different constructs related to it. <code>32 = 16 single targeting and 16 double targeting</code></p>
<ul>
<li>There are 16 <code>double targeting</code>: <code>geneA_geneBpg1, geneA_geneBpg2, ... geneA_geneBpg16</code>.</li>
<li>4 unique targeting sequences for <code>gene A</code> * 4 unique targeting sequences for <code>gene B</code> = 16 unique combos of double targeting constructs.</li>
<li>There are 16 <code>single targeting</code> in relation to this <code>geneA_geneB</code> construct. There are: <code>geneA_ctrl</code> and <code>ctrl_geneB</code> sequences.</li>
<li>(4 unique targeting sequences (<code>"geneA"</code>) * 2 non targeting sequences (<code>"ctrl"</code>) = 8 constructs)</li>
<li>(2 non targeting sequences (<code>"ctrl"</code>) * 4 unique targeting sequences (<code>"geneB"</code>) = 8 constructs)</li>
</ul>
</div>
<div class="section level2">
<h2 id="about-genetic-interaction-scores">About Genetic Interaction Scores<a class="anchor" aria-label="anchor" href="#about-genetic-interaction-scores"></a>
</h2>
<p>The output of the <code>gimap</code> package is genetic interaction scores which are <em>the distance between the observed CRISPR score and the expected CRISPR score.</em> The expected CRISPR scores are what we expect for the CRISPR values to be for two unrelated genes. The further away an observed CRISPR score is from its expected score the more we suspect genetic interaction.</p>
<p>This can be true in a positive way (a CRISPR knockout pair caused more cell proliferation than expected – called cooperativity) or in a negative way (a CRISPR knockout pair caused more cell lethality than expected – called synthetic lethality).</p>
<p>The genetic interaction scores are based on a linear model calculated for each sample where <code>observed_crispr_single</code> is the outcome variable and <code>expected_crispr_single</code> is the predictor variable.</p>
<p><strong>For each sample:</strong></p>
<pre><code><span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">observed_crispr_single</span> <span class="op">~</span> <span class="va">expected_crispr_single</span><span class="op">)</span></span></code></pre>
<p>Using <code>y = mx+b</code>, we can fill in the following values: * <code>y</code> = observed CRISPR score * <code>x</code> = expected CRISPR score * <code>m</code> = slope from linear model for this sample * <code>b</code> = intercept from linear model for this sample</p>
<p>The intercept and slope from this linear model are used to adjust the CRISPR scores for each sample:</p>
<pre><code>single_target_gi_score = observed single crispr - (intercept + slope * expected single crispr)
double_target_gi_score = double crispr score - (intercept + slope * expected double crispr)</code></pre>
<p>These single and double target genetic interaction scores are calculated at the construct level and are then summarized using a t-test to see if the the distribution of the set of double targeting constructs is significantly different than the overall distribution of single targeting constructs. After multiple testing correction, FDR values are reported. Low FDR value for a double construct means high likelihood of paralog redundancy, also known as synthetic lethality.</p>
<div class="section level4">
<h4 id="expected-crispr-scores">Expected CRISPR scores<a class="anchor" aria-label="anchor" href="#expected-crispr-scores"></a>
</h4>
<p>Expected CRISPR scores are calculated based on the pgRNAs included.</p>
<p>For a <code>double_targeting</code> construct we would expect the CRISPR score to be the sum of the single targeting CRISPR scores which use the same gRNA sequences present in the pgRNA.</p>
<pre><code>expected crispr double = single target crispr 1 + single target crispr 2</code></pre>
<p>So in the instance of the double construct <code>GSN_SCIN_pg1</code> we would expect its CRISPR score to be the same as <code>GSN_ctrl</code> + <code>ctrl_SCIN</code> where the pgRNA used to target GSN and SCIN respectively are the same.</p>
<p>For <code>single_targeting</code> constructs we would expect the CRISPR score to be the sum of a single target plus the mean of the control pgRNAs from the <code>negative control constructs</code> (or double non-targeting CRISPR constructs).</p>
<pre><code>expected crispr single = single target crispr 1 + mean negative control for the pgRNA</code></pre>
<p>So for <code>TRPC5_nt1</code> single target we would take its CRISPR score + the mean of the <code>nt1</code> sequence across the constructs where it is included in a double non targeting construct.</p>
</div>
<div class="section level3">
<h3 id="t-tests">t-tests<a class="anchor" aria-label="anchor" href="#t-tests"></a>
</h3>
<p>Genetic Interaction scores are used to calculate p values using a t-test.</p>
<p>For each gene pair…</p>
<p>A t-test compares: 1) The distribution of all single target GI scores 2) The distribution of the data from the 16 double targeting constructs for the particular gene pair</p>
<p>These t-tests can be performed with all samples combined or for each sample using the <code>stat_by_rep</code> argument in <code><a href="reference/calc_gi.html">calc_gi()</a></code>. False discovery rate is then applied after the p values are obtained to account for multiple testing correction.</p>
</div>
<div class="section level3">
<h3 id="normalization">Normalization<a class="anchor" aria-label="anchor" href="#normalization"></a>
</h3>
<p>gimap takes in a counts matrix that represents the number of cells that have each type of pgRNA. This data needs some normalization before CRISPR scores and Genetic Interaction scores can be calculated.</p>
<p>There are four steps of normalization. 1. <code>Calculate log2CPM</code> - First we account for different read depths across samples and transform data to log2 counts per million reads.</p>
<pre><code>log2((counts / total counts for sample)) * 1 million) + 1)</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>
<code>Calculate log2 fold change</code> - This is done by subtracting the log2CPM for the pre-treatment from each sample. control is what is highlighted. The pretreatment is the day 0 of CRISPR treatment, before CRISPR pgRNAs have taken effect.</li>
</ol>
<pre><code>log2FC = log2CPM for each sample - pretreament log2CPM</code></pre>
<p>Since the pgPEN library uses non-targeting controls, we adjust for the fact that single-targeting pgRNAs generate only two double-strand breaks (1 per allele), whereas the double-targeting pgRNAs generate four DSBs. To do this, we set the median LFC of each group to zero.</p>
<p>Calculate medians of based on single and double targeting and subtract these medians from <code>log2FC adjusted</code></p>
<ol start="3" style="list-style-type: decimal">
<li>CRISPR scores: <code>Normalize by negative and positive controls</code> - Calculate a negative control median for each sample and a positive control median for each sample and divide each log2FC by this value. In this version then we are normalizing by the median difference of the negative and positive controls.</li>
</ol>
<pre><code># FOR EACH SAMPLE:
log2FC adjusted =
(log2FC - log2FC median negative control) /
(log2FC median negative control - median log2FC positive control)</code></pre>
</div>
</div>
<div class="section level2">
<h2 id="prerequisites">Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"></a>
</h2>
<p>In order to run this pipeline you will need R and to install the <code>gimap</code> package and its dependencies. In R you can run this to install the package:</p>
<pre><code><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"FredHutch/gimap"</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="getting-started-tutorial">Getting Started Tutorial<a class="anchor" aria-label="anchor" href="#getting-started-tutorial"></a>
</h2>
<p>Now you can <a href="https://fredhutch.github.io/gimap/articles/quick-start.html" class="external-link">go to our quick start tutorial to get started!</a></p>
<p>We also have tutorial examples that show how to run timepoint or treatment experimental set ups with gimap:</p>
<ul>
<li><a href="https://fredhutch.github.io/gimap/articles/timepoint-example.html" class="external-link">Timepoint example</a></li>
<li><a href="https://fredhutch.github.io/gimap/articles/treatment_example.html" class="external-link">Treatment example</a></li>
</ul>
<p>Follow the steps there that will walk you through the example data. Then you can tailor that tutorial to use your own data.</p>
</div>
<div class="section level2">
<h2 id="docker-image">Docker image<a class="anchor" aria-label="anchor" href="#docker-image"></a>
</h2>
<p>You can use gimap interactively using the docker image like this:</p>
<pre><code>docker run -d -v $PWD:/home/rstudio -e PASSWORD=rstudio -p 8787:8787 cansav09/gimap</code></pre>
<p>Where all files at your current working directory will be available to this container.</p>
<p>You can access this container’s rstudio interactively and work from here by typing your browser:</p>
<pre><code>http://localhost:8787/</code></pre>
<p>And then putting “rstudio” for both the username and password.</p>
</div>
<div class="section level2">
<h2 id="citations">Citations:<a class="anchor" aria-label="anchor" href="#citations"></a>
</h2>
<ul>
<li><a href="https://pubmed.ncbi.nlm.nih.gov/34469736/" class="external-link uri">https://pubmed.ncbi.nlm.nih.gov/34469736/</a></li>
<li><a href="https://www.nature.com/articles/s43586-021-00093-4" class="external-link uri">https://www.nature.com/articles/s43586-021-00093-4</a></li>
</ul>
<div class="float">
<img src="https://cauldron.io/project/8779/stats.svg" alt="See metrics about this repository here"><div class="figcaption">See metrics about this repository here</div>
</div>
<p>* This work is funded by NCI grant R01CA262556 as well as funding from the Translational Data Science IRC of Fred Hutchinson Cancer Center.</p>
<p>Email <a href="mailto:csavonen@fredhutch.org" class="email">csavonen@fredhutch.org</a> with any questions!</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=gimap" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/FredHutch/gimap/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/FredHutch/gimap/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing gimap</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Candace Savonen <br><small class="roles"> Author, maintainer </small>  </li>
<li>Phoebe Parrish <br><small class="roles"> Author </small>  </li>
<li>Kate Isaac <br><small class="roles"> Author </small>  </li>
<li>Howard Baek <br><small class="roles"> Author </small>  </li>
<li>Daniel Grosso <br><small class="roles"> Author </small>  </li>
<li>Siobhan O'Brien <br><small class="roles"> Author </small>  </li>
<li>Alice Berger <br><small class="roles"> Author </small>  </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Candace Savonen, Phoebe Parrish, Kate Isaac, Howard Baek, Daniel Grosso, Siobhan O’Brien, Alice Berger.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
